.TH SSHCTL 1 "2025-12-15" "sshctl 2.x" "User Commands"

.SH NAME
sshctl \- manage and connect to SSH connections via JSON configuration

.SH SYNOPSIS
.B sshctl
[\fIGLOBAL_OPTIONS\fR] [\fIMODE\fR] [\fIEXPR\fR]

.SH DESCRIPTION
.B sshctl
은(는) JSON 기반 configuration 파일에 SSH 연결정보(connection)를 저장하고,
추가/수정/삭제/그룹이동/목록조회/접속 등을 CLI로 제공하는 유틸리티이다.
민감정보(username, credential)는 항상 암호화된 상태로 설정 파일에 저장되며,
실행 시 점진적으로 복호화하여 사용한다.

.SH GLOBAL OPTIONS
.TP
.BR --config " " \fIFILE\fR
설정 파일 경로를 지정한다. 파일이 없으면 경고 후 기본 설정 파일
(\fI$HOME/.sshctl/configuration.conf\fR)로 fallback 한다.

.TP
.BR --masterkey " " \fIFILE\fR
암복호화에 사용할 OpenSSH private key 파일 경로를 지정한다.
지정하지 않으면 기본 masterkey(\fI$HOME/.sshctl/masterkey\fR)가 사용된다.

.TP
.BR -s ", " --show-credential
목록/미리보기 출력 시 credential 칼럼의 평문 표시를 요청하는 플래그이다.
실제로 평문이 허용되는지 여부는 모드별 정책에 따른다.
대표적으로
.B --list-all
모드에서 masking list ↔ plain list 전환에 사용된다.

.TP
.BR -h ", " --help
에러 원인(cause), callstack(존재 시) 및 전체 Usage를 출력한다.

.SH MODES
아래 모드는 서로 상호 배타적이며, 동시에 하나만 사용할 수 있다.

.TP
.BR --add-connection ", " -a
새로운 SSH 연결정보를 추가한다. 인터랙티브하게 group, name, host_type, host,
port, username, credential 등을 입력받아 암호화 후 configuration 에 저장한다.

.TP
.BR --modify-connection ", " -m
기존 연결정보를 수정한다. 먼저 후보 목록을 plain list로 보여준 뒤,
선택한 항목에 대해 수정 필드를 인터랙티브하게 입력받는다.

.TP
.BR --delete-connection ", " -d
연결정보를 삭제한다. 삭제 대상 후보 목록은 항상 masking list로 표시되며,
credential 평문은 노출되지 않는다.

.TP
.BR --move-group-connection ", " -mg
선택한 연결정보의 group 필드만 변경한다. credential 은 항상 masking 상태를 유지하며,
미리보기에서도 평문이 표시되지 않는다.

.TP
.BR --list-all ", " -l
모든 연결정보를 테이블 형태로 출력한다. 기본적으로 masking list를 사용하며,
.BR --show-credential " / " -s
가 함께 지정된 경우 허용된 범위 내에서 plain list로 표시된다.

.SH POSITIONAL ARGUMENTS
.TP
\fIEXPR\fR
모드 옵션 없이 사용되거나, 일부 모드에서 함께 사용되는 검색 표현식이다.
name, group, host 등을 기준으로 부분 문자열 매칭을 수행하며,
검색 결과가 1개인 경우 자동 접속, 여러 개인 경우 선택 목록을 보여준다.

.SH CONFIGURATION
설정 파일은 JSON 형식이며 기본 위치는 다음과 같다.

.nf
  Directory: $HOME/.sshctl
  File     : $HOME/.sshctl/configuration.conf
.fi

configuration 파일에는 version, masterkey_md5, connections 배열 등이 포함되며,
각 connection 객체는 group, name, host_type, host, port, username, auth_type,
credential 필드를 가진다.

.SH COMPLETION
.B sshctl
은 bash completion 스크립트(\fIsshctl.completion\fR)를 통해 다음을 지원한다.

.IP \[bu]
모든 long/short 옵션 자동 완성
.IP \[bu]
모드 옵션 상호 배타 처리 (한 번 선택되면 다른 모드 미제안)
.IP \[bu]
전역 옵션 중복 방지 (이미 사용된 옵션은 다시 제안하지 않음)
.IP \[bu]
.B --list-all / -l
사용 시에만
.B --show-credential / -s
제안
.IP \[bu]
비옵션 위치에서는 configuration 의 connection.name 기반 검색어 자동 완성

completion 스크립트는 일반적으로 다음 위치에 설치한다.

.nf
  /etc/bash_completion.d/sshctl
.fi

.SH FILES
.TP
.B $HOME/.sshctl/configuration.conf
SSH 연결정보가 암호화된 상태로 저장되는 기본 설정 파일.

.TP
.B $HOME/.sshctl/masterkey
암/복호화를 위한 OpenSSH private key 파일.

.SH SEE ALSO
.BR ssh (1),
.BR ssh-keygen (1),
.BR jq (1)

.SH AUTHOR
parkjunhong77@gmail.com
